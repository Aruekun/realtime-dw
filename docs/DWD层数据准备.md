#  需求分析及实现思路

## 分层需求分析

在之前介绍实时数仓概念时讨论过，建设实时数仓的目的，主要是增加数据计算的复用

性，对数据以及服务之间进行解耦。每次新增加统计需求时，不至于从原始数据进行计算，而是从半成品继续加工而成。

我们这里从 kafka 的 ods 层读取用户行为日志以及业务数据，并进行简单处理，写回到kafka作为 dwd 层。

<img src="DWD层数据准备.assets/image-20210407224537117.png" alt="image-20210407224537117" style="zoom:50%;" />

## 每层的职能

| 分层 | 数据描述                                               | 数据计算          | 存储       |
| ---- | ------------------------------------------------------ | ----------------- | ---------- |
| ODS  | 原始数据，日志和业务数据                               | 日志服务器，canal | kafka      |
| DWD  | 明细数据层，比如订单、页面访问等                       | flink             | Kafka      |
|      |                                                        |                   |            |
| DIM  | 维度数据                                               | flink             | HBase      |
| DWS  | 根据某个维度主题将多个事实数据轻度聚合，形成主题宽表。 | flink             | Clickhouse |
| ADS  | 基于dws数据实时指标计算                                | flink             | myql/HBase |
| OLAP | OLAP查询                                               | clickhouse        | clickhouse |



# 业务数据DWD层

##  需求分析与思路

订单是统计分析的重要的对象，围绕订单有很多的维度统计需求，比如用户、地区、商

品、品类、品牌等等。

为了之后统计计算更加方便，减少大表之间的关联，所以在实时计算过程中将围绕订单

的相关数据整合成为一张订单的宽表。

那究竟哪些数据需要和订单整合在一起？